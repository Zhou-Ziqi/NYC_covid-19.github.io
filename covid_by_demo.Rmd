---
title: "covid_by_demographics"

output: 
  html_document:
    code_folding: hide
    toc: true
    toc_float: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(rgdal)
library(sp)
library(tmap)  
library(readxl)
library(viridis)
library(leaflet)
library(tigris)
library(plotly)
library(ggthemes)
library(RColorBrewer)
library(patchwork)

```

# by age
```{r, include=FALSE,message=FALSE,warning=FALSE}
#read the data

byage0518 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0518.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-05-18",
         day = as.Date(day))

byage0519 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0519.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-05-19",
         day = as.Date(day))
byage0520 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0520.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-05-20",
         day = as.Date(day))
byage0521 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0521.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-05-21",
         day = as.Date(day))
byage0522 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0522.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-05-22",
         day = as.Date(day))
byage0523 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0523.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-05-23",
         day = as.Date(day))
byage0524 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0524.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-05-24",
         day = as.Date(day))
byage0525 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0525.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-05-25",
         day = as.Date(day))
byage0526 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0526.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-05-26",
         day = as.Date(day))
byage0527 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0527.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-05-27",
         day = as.Date(day))
byage0528 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0528.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-05-28",
         day = as.Date(day))
byage0529 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0529.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-05-29",
         day = as.Date(day))
byage0530 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0530.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-05-30",
         day = as.Date(day))
byage0531 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0531.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-05-31",
         day = as.Date(day))

byage0601 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0601.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-06-01",
         day = as.Date(day))
byage0602 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0602.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-06-02",
         day = as.Date(day))
byage0603 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0603.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-06-03",
         day = as.Date(day))
byage0604 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0604.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-06-04",
         day = as.Date(day))
byage0605 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0605.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count") %>% 
  mutate(day = "2020-06-05",
         day = as.Date(day))

byage0606 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0606.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-06-06",
         day = as.Date(day))
byage0607 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0607.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-06-07",
         day = as.Date(day))
byage0608 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0608.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-06-08",
         day = as.Date(day))
byage0609 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0609.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-06-09",
         day = as.Date(day))

byage0610 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0610.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-06-10",
         day = as.Date(day))
byage0611 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0611.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-06-11",
         day = as.Date(day))
byage0612 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0612.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-06-12",
         day = as.Date(day))
byage0613 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0613.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-06-13",
         day = as.Date(day))
byage0614 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0614.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-06-14",
         day = as.Date(day))

byage0615 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0615.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-06-15",
         day = as.Date(day))
byage0616 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0616.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-06-16",
         day = as.Date(day))
byage0617 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0617.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-06-17",
         day = as.Date(day))


byage0618 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0618.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-06-18",
         day = as.Date(day))
byage0619 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0619.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-06-19",
         day = as.Date(day))
byage0620 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0620.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-06-20",
         day = as.Date(day))


byage0621 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0621.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-06-21",
         day = as.Date(day))
byage0622 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0622.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-06-22",
         day = as.Date(day))
byage0623 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0623.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-06-23",
         day = as.Date(day))

byage0624 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0624.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-06-24",
         day = as.Date(day))
byage0625 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0625.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-06-25",
         day = as.Date(day))
byage0626 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0626.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-06-26",
         day = as.Date(day))

byage0627 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0627.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-06-27",
         day = as.Date(day))

byage0628 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0628.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-06-28",
         day = as.Date(day))

byage0630 = read_csv("./data/data_covid_demo/boros_by_age/boroughs-by-age0630.csv") %>% 
  pivot_longer(BK_CASE_COUNT:SI_DEATH_RATE,
               names_to = "location_n_event",
               values_to = "count")%>% 
  mutate(day = "2020-06-30",
         day = as.Date(day))
```

```{r,include=FALSE,message=FALSE,warning=FALSE}
byage = rbind(byage0518,byage0519)
byage = rbind(byage,byage0520)
byage = rbind(byage,byage0521)
byage = rbind(byage,byage0522)
byage = rbind(byage,byage0523)
byage = rbind(byage,byage0524)
byage = rbind(byage,byage0525)
byage = rbind(byage,byage0526)
byage = rbind(byage,byage0527)
byage = rbind(byage,byage0528)
byage = rbind(byage,byage0529)
byage = rbind(byage,byage0530)
byage = rbind(byage,byage0531)
byage = rbind(byage,byage0601)
byage = rbind(byage,byage0602)
byage = rbind(byage,byage0603)
byage = rbind(byage,byage0604)
byage = rbind(byage,byage0605)
byage = rbind(byage,byage0606)
byage = rbind(byage,byage0607)
byage = rbind(byage,byage0608)
byage = rbind(byage,byage0609)
byage = rbind(byage,byage0610)
byage = rbind(byage,byage0611)
byage = rbind(byage,byage0612)
byage = rbind(byage,byage0613)
byage = rbind(byage,byage0614)
byage = rbind(byage,byage0615)
byage = rbind(byage,byage0616)
byage = rbind(byage,byage0617)
byage = rbind(byage,byage0618)
byage = rbind(byage,byage0619)
byage = rbind(byage,byage0620)
byage = rbind(byage,byage0621)
byage = rbind(byage,byage0622)
byage = rbind(byage,byage0623)
byage = rbind(byage,byage0624)
byage = rbind(byage,byage0625)
byage = rbind(byage,byage0626)
byage = rbind(byage,byage0627)
byage = rbind(byage,byage0628)

byage = rbind(byage,byage0630)

write_csv(byage,"./distribution_of_covid-19/data/demoage_data.csv")
```


```{r,include=FALSE,message=FALSE,warning=FALSE}
boro_age_case_count = byage %>% 
  filter(str_detect(location_n_event,"CASE_COUNT"))

boro_age_hosp_count = byage %>% 
  filter(str_detect(location_n_event,"HOSPITALIZED_COUNT"))

boro_age_death_count = byage %>% 
  filter(str_detect(location_n_event,"DEATH_COUNT"))

boro_age_case_rate = byage %>% 
  filter(str_detect(location_n_event,"CASE_RATE"))

boro_age_hosp_rate = byage %>% 
  filter(str_detect(location_n_event,"HOSPITALIZED_RATE"))

boro_age_death_rate = byage %>% 
  filter(str_detect(location_n_event,"DEATH_RATE"))

```

```{r, include=FALSE}
boromap = rgdal::readOGR("./Geography-resources/Borough Boundaries.geojson")
boromap@data
```

258x5

```{r,include=FALSE,message=FALSE,warning=FALSE}
boros = rep(c("Brooklyn","Bronx","Manhattan","Queens","Staten Island"),258)

boro_age_case_count = boro_age_case_count %>% 
  mutate(location = boros)
boro_age_hosp_count = boro_age_hosp_count%>% 
  mutate(location = boros)
boro_age_death_count = boro_age_death_count%>% 
  mutate(location = boros)
boro_age_case_rate = boro_age_case_rate%>% 
  mutate(location = boros)
boro_age_hosp_rate = boro_age_hosp_rate%>% 
  mutate(location = boros)
boro_age_death_rate = boro_age_death_rate%>% 
  mutate(location = boros)
```

```{r, eval = FALSE}
data_to_plot = boro_age_case_count %>% 
  filter(day == "2020-06-30" & 
           location == "Brooklyn" & 
           group != "Boroughwide") 

case_map_data = boro_age_case_count %>% 
  filter(group == "Boroughwide" & day == "2020-06-30") 

case_map = geo_join(boromap,case_map_data,"boro_name" ,"location")

pal <- colorNumeric("Greens", domain=case_map_data $count)
    
    popup_sb <- paste0("BORO Name: ", as.character(case_map_data$location),
                       "<br>", 
                       "Total Number of Cumulative Positive Cases: ", as.character(case_map_data$count)
    )
    
leaflet() %>%
        addProviderTiles("CartoDB.Positron") %>%
        setView(lng = -73.99653, lat = 40.75074, zoom = 10) %>% 
        addPolygons(data =  case_map , 
                    fillColor = ~pal(case_map_data$count), 
                    fillOpacity = 0.7, 
                    weight = 0.2, 
                    smoothFactor = 0.2, 
                    popup = ~popup_sb) %>%
        addLegend(pal = pal, 
                  values =  case_map_data$count, 
                  position = "bottomright", 
                  title = "Number")
```

```{r}
```

### Brooklyn Case Count Age Distribution.
```{r}
data_to_plot = boro_age_case_count %>% 
  filter(day == "2020-06-30" & 
           location == "Brooklyn" & 
           group != "Boroughwide") 


plot_ly(labels = paste0("Age Group: ", data_to_plot$group),
                    values = data_to_plot$count,
                    type = "pie",
                    marker = list(colors = brewer.pal(7,"Blues")),
                    sort = FALSE,
                    opacity=0.8) %>% 
                layout(legend=list(title=list(text='<b> Age Group </b>'),orientation = 'h', 
                                   xanchor = "center", 
                                   x = 0.5, y = -0.5))
```

### Bronx Case Count Age Distribution.

```{r}
data_to_plot = boro_age_case_count %>% 
  filter(day == "2020-06-30" & 
           location == "Bronx" & 
           group != "Boroughwide") 

plot_ly(labels = paste0("Age Group: ", data_to_plot$group),
                    values = data_to_plot$count,
                    type = "pie",
                    marker = list(colors = brewer.pal(7,"Blues")),
                    sort = FALSE,
                    opacity=0.8) %>% 
                layout(legend=list(title=list(text='<b> Age Group </b>'),orientation = 'h', 
                                   xanchor = "center", 
                                   x = 0.5, y = -0.5))
```



### Brooklyn Hospitalization Count Age Distribution.
```{r}
data_to_plot2 = boro_age_hosp_count %>% 
  filter(day == "2020-06-30" & 
           location == "Brooklyn" & 
           group != "Boroughwide") 

plot_ly(labels = paste0("Age Group: ", data_to_plot2$group),
                    values = data_to_plot$count,
                    type = "pie",
                    marker = list(colors = brewer.pal(7,"Blues")),
                    sort = FALSE,
                    opacity=0.8) %>% 
                layout(legend=list(title=list(text='<b> Age Group </b>'),orientation = 'h', xanchor = "center", 
                                   x = 0.5, y = -0.5))

```

### Brooklyn Death Count Age Distribution.
```{r}
data_to_plot3 = boro_age_death_count %>% 
  filter(day == "2020-06-30" & 
           location == "Brooklyn" & 
           group != "Boroughwide") 

plot_ly(labels = paste0("Age Group: ", data_to_plot3$group),
                    values = data_to_plot$count,
                    type = "pie",
                    marker = list(colors = brewer.pal(7,"Blues")),
                    sort = FALSE,
                    opacity=0.8) %>% 
                layout(legend=list(title=list(text='<b> Age Group </b>'),orientation = 'h', 
                                   xanchor = "center", 
                                   x = 0.5, y = -0.5))
```


### Brooklyn Case Rate Age Distribution.
```{r}
data_to_plot4 = boro_age_case_rate %>% 
  filter(day == "2020-06-30" & 
           location == "Brooklyn" & 
           group != "Boroughwide") 

plot_ly(labels = paste0("Age Group: ", data_to_plot4$group),
                    values = data_to_plot$count,
                    type = "pie",
                    marker = list(colors = brewer.pal(7,"Blues")),
                    sort = FALSE,
                    opacity=0.8) %>% 
                layout(legend=list(title=list(text='<b> Age Group </b>'),orientation = 'h', 
                                   xanchor = "center", 
                                   x = 0.5, y = -0.5))
```

### Brooklyn Hospitalization Rate Age Distribution.
```{r}
data_to_plot5 = boro_age_hosp_rate %>% 
  filter(day == "2020-06-30" & 
           location == "Brooklyn" & 
           group != "Boroughwide") 
plot_ly(labels = paste0("Age Group: ", data_to_plot5$group),
                    values = data_to_plot$count,
                    type = "pie",
                    marker = list(colors = brewer.pal(7,"Blues")),
                    sort = FALSE,
                    opacity=0.8) %>% 
                layout(legend=list(title=list(text='<b> Age Group </b>'),orientation = 'h', 
                                   xanchor = "center", 
                                   x = 0.5, y = -0.5))
```

### Brooklyn Death Rate Age Distribution.
```{r}
data_to_plot6 = boro_age_death_rate %>% 
  filter(day == "2020-06-30" & 
           location == "Brooklyn" & 
           group != "Boroughwide") 
plot_ly(labels = paste0("Age Group: ", data_to_plot6$group),
                    values = data_to_plot$count,
                    type = "pie",
                    marker = list(colors = brewer.pal(7,"Blues")),
                    sort = FALSE,
                    opacity=0.8) %>% 
                layout(legend=list(title=list(text='<b> Age Group </b>'),orientation = 'h', 
                                   xanchor = "center", 
                                   x = 0.5, y = -0.5))
```

### Brooklyn Hospitalization Count Age Distribution.

```{r}
data_to_plot7 = boro_age_hosp_count %>% 
  filter(day == "2020-06-30" & 
           location == "Brooklyn" & 
           group != "Boroughwide") 

plot_ly(labels = paste0("Age Group: ", data_to_plot7$group),
                    values = data_to_plot$count,
                    type = "pie",
                    marker = list(colors = brewer.pal(7,"Blues")),
                    sort = FALSE,
                    opacity=0.8) %>% 
                layout(legend=list(title=list(text='<b> Age Group </b>'),orientation = 'h', 
                                   xanchor = "center", 
                                   x = 0.5, y = -0.5))
```















```{r, eval = FALSE}
demo_by_age = read.csv("./distribution_of_covid-19/data/demoage_data.csv")
boros1 = rep(c("Brooklyn","Bronx","Manhattan","Queens","Staten Island"),258)

boro_age_case_count = demo_by_age %>% 
    filter(str_detect(location_n_event,"CASE_COUNT")) %>% 
    mutate(location = boros1)

boro_age_hosp_count = demo_by_age %>% 
    filter(str_detect(location_n_event,"HOSPITALIZED_COUNT")) %>% 
    mutate(location = boros1)

boro_age_death_count = demo_by_age %>% 
    filter(str_detect(location_n_event,"DEATH_COUNT")) %>% 
    mutate(location = boros1)

boro_age_case_rate = demo_by_age %>% 
    filter(str_detect(location_n_event,"CASE_RATE")) %>% 
    mutate(location = boros1)

boro_age_hosp_rate = demo_by_age %>% 
    filter(str_detect(location_n_event,"HOSPITALIZED_RATE")) %>% 
    mutate(location = boros1)

boro_age_death_rate = demo_by_age %>% 
    filter(str_detect(location_n_event,"DEATH_RATE")) %>% 
    mutate(location = boros1)

```

